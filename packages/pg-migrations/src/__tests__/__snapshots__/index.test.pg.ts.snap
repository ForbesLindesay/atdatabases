// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`apply - after already appying 1`] = `
"stdout:
  Applying 00001-init.ts
  
stderr:
  error: relation \\"users\\" already exists
      at handleError (/Users/forbeslindesay/Documents/GitHub/atdatabases/packages/pg/lib/Driver.js:397:29)
      at executeQueryInternal (/Users/forbeslindesay/Documents/GitHub/atdatabases/packages/pg/lib/Driver.js:369:9)
      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
      at async PgDriver._executeQuery (/Users/forbeslindesay/Documents/GitHub/atdatabases/packages/pg/lib/Driver.js:199:29)
      at async PgDriver.executeAndReturnLast (/Users/forbeslindesay/Documents/GitHub/atdatabases/packages/pg/lib/Driver.js:224:13)
      at async Transaction.query (/Users/forbeslindesay/Documents/GitHub/atdatabases/packages/shared/lib/BaseTransaction.js:59:24)
      at async applyMigration (/Users/forbeslindesay/Documents/GitHub/atdatabases/packages/pg-migrations/src/__tests__/migrations/00001-init.ts:4:3)
      at async Object.applyMigration (/Users/forbeslindesay/Documents/GitHub/atdatabases/packages/pg-migrations/lib/PostgresDatabaseEngine.js:137:21)
      at async /Users/forbeslindesay/Documents/GitHub/atdatabases/packages/migrations-base/lib/methods/applyOperations.js:43:29
      at async /Users/forbeslindesay/Documents/GitHub/atdatabases/packages/pg-migrations/lib/PostgresDatabaseEngine.js:54:20
  "
`;

exports[`apply - missing directory 1`] = `
"stdout:
  
stderr:
  You must supply a directory path for your migrations. You can supply it as either:
  
   - The migrationsDirectory config value using @databases/pg-config
   - The --directory parameter when calling @databases/pg-migrations
  
  "
`;

exports[`apply --dry-run - after already appying 1`] = `
"stdout:
  Applying 00001-init.ts (dry run only)
  Applied 00001-init.ts (dry run only, not actually applied)
  Applying 00002-update.ts (dry run only)
  Applied 00002-update.ts (dry run only, not actually applied)
  Applying 00003-update2.sql (dry run only)
  Applied 00003-update2.sql (dry run only, not actually applied)
  To apply 3 migrations, run again without --dry-run
  
stderr:
  "
`;

exports[`apply --dry-run 1`] = `
"stdout:
  To update your database, run again without --dry-run
  
stderr:
  This database has not been migrated using @databases/pg-migrations version 2.0.0 before.
  Version updates cannot be automaticaly applied when --dry-run is enabled.
  "
`;

exports[`apply 1`] = `
"stdout:
  Applying 00001-init.ts
  Applied 00001-init.ts
  Applying 00002-update.ts
  Applied 00002-update.ts
  Applying 00003-update2.sql
  Applied 00003-update2.sql
  3 migrations applied
  
stderr:
  "
`;

exports[`help 1`] = `
"stdout:
  Available commands:
  
  pg-migrations apply           - Apply any pending migration
  pg-migrations ignore-error    - Permanently ignore an error for a migration
  pg-migrations mark-applied    - Mark migration as applied (without applying it)
  pg-migrations mark-unapplied  - Mark migration as unapplied (without reverting it)
  pg-migrations restore-from-db - Restore a previously applied migration from the database
  
  For more information on a command, run:
  
  pg-migrations help <COMMAND_NAME>
  
stderr:
  "
`;

exports[`help apply 1`] = `
"stdout:
  Apply Migrations
  
  Usage: pg-migrations apply [options]
  
  Parameters:
  -c --database         A connection string for the database you want to connect to (can also be supplied as the environment variable PG_URL).
  -D --directory        The directory containing migrations (can also be supplied via the \\"migrationsDirectory\\" config option).
     --version-table    A table to store the version of @databases used. Defaults to \\"atdatabases_migrations_version\\".
     --migrations-table A table to store the applied migrations. Defaults to \\"atdatabases_migrations_applied\\".
  -e --ignore-error     Error code to ignore (can use multiple times to ignore multiple errors)
  -d --dry-run          Do actually modify the database or file system.
  
stderr:
  "
`;
